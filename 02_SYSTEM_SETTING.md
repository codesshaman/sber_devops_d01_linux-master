# Настройки системы

Теперь приступаем непосредственно к заданию. По сути мы уже выполнили Part 1 - установили систему, и Part 8 - сделали доступ по ssh. Далее перечислим нужные нам моменты, которые есть в тех или иных частях задания. В заголовке будет обозначена часть (например, Part 1.), внутри будут подзаголовки, в которых расписаны шаги, необходимые для выполнения этой части.

Начнём с простого. Для примера выполним задание из 

## Part 1. Установка ОС

### Шаг 1. Вывод версии

Здесь нам нужно просто нужно выполнить команду ``cat /etc/issue.`` и вставить скриншот с выводом команды.

Все остальные шаги выполнены в первом гайде.

Идём дальше.

## Part 2. Создание пользователя

Для создания пользователей в линукс существуют две разные команды - adduser и useradd. Поупражняться в них можно самостоятельно, я же покажу, как создать пользователя на примере adduser.

### Шаг 1. Создание пользователя

Просто выполняем команду ``sudo adduser user2`` и она создаст нам пользователя "user2", попутно спросив к нему пароль (поставил такой же - единицу) и кучу ненужной информации, которую можно пропустить просто нажимая "Enter":

![установка ubuntu](media/system_settings/step_00.png)

По заданию нужно будет отправить свой скриншот с вызовом команды создания пользователя.

### Шаг 2. Чтение логов

Теперь дадим нашему пользователю права на чтение логов. Для этого добавим его в группу adm. Нет, не в слаке, в системе:

``sudo usermod -aG adm user2``

После этого перейдём на созданного пользователя:

``su user2``

Проверим, записался ли он в группу adm:

``groups``

Если в выводе мы увидим adm, значит мы можем читать логи.

Теперь выведем cat-ом главный системный лог:

``cat /var/log/syslog``

Мы получим много информации из системного журнала за текущий день. Таким образом, доступ к логам у нас есть.

### Шаг 3. cat /etc/passwd

Так же нам нужно выполнить ``cat /etc/passwd`` и отправить скрин с выводом этой команды. В самом конце файла должен наблюдаться наш созданный пользователь.

Теперь выходим из под нового пользователя, вернувшись к системному по ``control+D``.

## Part 3. Настройка сети ОС

### Шаг 1. Изменение имени хоста

Название машины хранится в /etc/hostname. Под старым пользователем изменим этот файл:

``nano /etc/hostname``

Заменим ubuntu_01 на user-1. Сохраняем файл и перезагружаемся по ``sudo reboot``. При следующем входе вместо "user@ubuntu01" нас встретит "user@user-1".

### Шаг 2. Изменение часового пояса

Текущий часовой пояс можно проверить командой ``timedatectl``, и вероятнее всего он равен UTC. Часовой пояс записывается в /etc/timezone, и при помощи ``cat /etc/timezone`` мы можем ещё раз убедиться, что ~~находимся на территории Англии~~ временная зона не настроена корректно.

Меняем часовой пояс командой:

``sudo timedatectl set-timezone Europe/Moscow``

где Europe/Moscow - наше месторасположение.

Теперь ``timedatectl`` покажет уже правильный часовой пояс, и ``cat /etc/timezone`` тоже.

### Шаг 3. Сетевые интерфейсы

Для работы с сетевым окружением в ubuntu используется утиллита net-tools. Установим её командой

``sudo apt install net-tools``

Теперь мы можем просмотреть нашу сетевую конфигурацию:

``ifconfig``

![установка ubuntu](media/system_settings/step_01.png)

В моём случае имеется интерфейс enp0s3, отвечающий за внешнюю сеть, и интерфейс lo, то есть loopback, отвечающий за сеть внутреннюю. Более подробно о нём расскажет гугл.

### Шаг 4. Получение сетевого адреса

При смене ip мы не сможем задействовать наш TTY, то есть интерфейс, по которому мы общались с системой через терминал. Поэтому мы открываем окно virtualbox и логинимся там.

Сначала сбросим старый ip через ``sudo dhclient -r enp0s3``, где enp0s3 - наш сетевой протокол из вывода ifconfig. Да, придётся вводить ручками :(

Снова выводим доступные сети ifconfig-ом:

![установка ubuntu](media/system_settings/step_02.png)

Как мы можем убедиться, ip-адрес отсутствует. Получим новый командой ``sudo dhclient -v enp0s3``

И мы получили новый адрес:

![установка ubuntu](media/system_settings/step_03.png)

ifconfig покажет, что теперь у нас есть IP:

![установка ubuntu](media/system_settings/step_04.png)

### Шаг 5. IP-адреса

Узнать свой внешний IP можно, обратившись к внешнему сайту, который вернёт нам наш адрес. Таких сервисов много, вот лишь некоторые из них.

``wget -O - -q icanhazip.com``

``wget -q -O - ifconfig.me/ip``

``curl ifconfig.me/ip``

Обращение происходить wget-ом и curl-ом - инструментами, позволяющими делать запросы в интернет из командной строки.

Внутренний IP (он же gateway) можно узнать командой ``route -n`` - в столбце Gateway будет искомый адрес.

### Шаг 6. Настройки IP

## Part 5. Использование команды sudo

Например, про права пользователей можно почитать на [irunner wiki](https://acm.bsu.by/wiki/Unix2017b/%D0%9F%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B8_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B0 "пользователи и права").